<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Plataforma do Caos</title>
<style>
html, body {
  margin:0; padding:0; overflow:hidden;
  background:#111; font-family:Arial, sans-serif;
  height:100vh; display:flex; flex-direction:column; justify-content:center; align-items:center;
}
h1 {
  font-size:60px; color:#0ff; text-shadow:0 0 20px #0ff, 0 0 40px #0ff;
  text-align:center; margin-bottom:30px;
}
button {
  padding:16px 32px; font-size:28px; border:none; border-radius:12px;
  cursor:pointer; background:#ff0066; color:white; font-weight:bold;
}
canvas { display:none; background:#111; }
#mobileControls { display:none; position:absolute; bottom:20px; width:100%; display:flex; justify-content:space-between; padding:0 30px; }
#joystick, #jumpBtn { pointer-events:auto; touch-action:none; }
#joystick {
  width:120px; height:120px; background:rgba(0,255,255,0.2); border-radius:50%;
  display:flex; justify-content:center; align-items:center; position:relative;
}
#joystickInner {
  width:60px; height:60px; background:rgba(0,255,255,0.5); border-radius:50%;
  position:absolute; left:30px; top:30px; transition:left 0.05s, top 0.05s;
}
#jumpBtn {
  width:80px; height:80px; background:rgba(255,255,0,0.6); border-radius:50%;
  font-size:40px; line-height:80px; color:#000; text-align:center;
}
</style>
</head>
<body>

<h1>PLATAFORMA DO CAOS</h1>
<button id="startBtn">START</button>
<canvas id="gameCanvas"></canvas>
<div id="mobileControls">
  <div id="joystick"><div id="joystickInner"></div></div>
  <div id="jumpBtn">↑</div>
</div>

<script>
// ===== Inicialização =====
const canvas=document.getElementById("gameCanvas");
const ctx=canvas.getContext("2d");
const startBtn=document.getElementById("startBtn");
const mobileControls=document.getElementById("mobileControls");
function resizeCanvas(){ canvas.width=window.innerWidth; canvas.height=window.innerHeight; }
window.addEventListener('resize',resizeCanvas); resizeCanvas();

// ===== Player =====
let player={x:50,y:0,w:30,h:30,vx:0,vy:0,onGround:false,color:'#0ff',glow:0};
const gravity=0.7,jumpForce=-13;
let camera={x:0,y:0},shake=0;
let keys={},mobileDir=0;

// ===== Plataformas, projéteis, spikes =====
let platforms=[],projectiles=[],goal={x:0,y:0,w:40,h:40};
let currentLevel=0,gameFinished=false;

// ===== IA Cruel =====
let aiMessage="",aiTimer=0;
const cruelMessages=[
  "HAHAHA! Caiu de novo? Patético!",
  "Você acha que consegue? Não mesmo!",
  "Olha esse fracasso ambulante...",
  "Cada morte sua é hilária!",
  "Não chora, o void te abraça!",
  "Tente de novo… ou não sobreviva.",
  "AHAHAHA, desastre humano detectado!",
  "Você realmente merece continuar? Duvido.",
  "HAHAHA! Você é minha diversão!"
];
function showAIMessage(msg){ aiMessage=msg; aiTimer=250; }

// ===== Geração de fases =====
const levels=[];
for(let lvl=0;lvl<40;lvl++){
  let pls=[];
  pls.push({x:0,y:canvas.height-20,w:canvas.width*3,fake:false,moving:false,dx:0,dy:0,breakable:false,disappear:false,color:'#0ff'});
  let y=canvas.height-120,x=50;
  while(x<canvas.width*3-50){
    let w=Math.random()*60+30,gap=Math.random()*50+20;
    let fake=Math.random()<0.25, moving=Math.random()<0.25;
    let breakable=Math.random()<0.25, disappear=Math.random()<0.2;
    let dx=moving?(Math.random()*6-3):0, dy=moving?(Math.random()*2-1):0;
    pls.push({x,y,w,h:20,fake,moving,dx,dy,breakable,disappear,visible:true,color:'#0ff'});
    x+=w+gap; y-=Math.random()*60;if(y<50)y=50;
  }
  let goalX=canvas.width*3-60, goalY=pls[pls.length-1].y-40;
  levels.push({platforms:pls,goal:{x:goalX,y:goalY,w:40,h:40,color:'#ff0'}});
}

// ===== Carrega fase =====
function loadLevel(n){
  currentLevel=n;
  let lvl=levels[n];
  platforms=lvl.platforms.map(p=>({...p,visible:true}));
  projectiles=[]; // limpa projéteis
  goal={...lvl.goal};
  player.x=50; player.y=canvas.height-50; player.vx=0; player.vy=0; player.onGround=false; player.glow=0;
  gameFinished=false;
}

// ===== Update =====
function update(){
  if(gameFinished)return;
  player.vx=0;
  if(keys["ArrowLeft"]||keys["a"]||mobileDir===-1) player.vx=-5;
  if(keys["ArrowRight"]||keys["d"]||mobileDir===1) player.vx=5;
  player.vy+=gravity; player.x+=player.vx; player.y+=player.vy;
  player.onGround=false;

  platforms.forEach(p=>{
    if(!p.visible)return;
    if(player.vy>=0 && player.x+player.w>p.x && player.x<p.x+p.w && player.y+player.h>p.y && player.y+player.h<p.y+p.h){
      player.y=p.y-player.h; player.vy=0; player.onGround=true;
      if(p.breakable)p.visible=false;
      if(p.disappear)p.visible=false;
    }
    if(p.moving){p.x+=p.dx;p.y+=p.dy;
      if(p.x<0||p.x+p.w>canvas.width*3)p.dx*=-1;
      if(p.y<50||p.y>canvas.height-50)p.dy*=-1;
    }
  });

  camera.x=player.x-canvas.width/2+player.w/2 + (Math.random()*shake-shake/2);
  camera.y=player.y-canvas.height/2+player.h/2 + (Math.random()*shake-shake/2);
  if(shake>0) shake--;

  // Projetéis (exemplo simples)
  projectiles.forEach(proj=>{
    proj.x+=proj.vx; proj.y+=proj.vy;
  });
}

// ===== Checa morte =====
function checkDeath(){
  let dead=false;
  if(player.y>canvas.height+200) dead=true;
  projectiles.forEach(p=>{
    if(player.x<p.x+p.w && player.x+player.w>p.x && player.y<p.y+p.h && player.y+player.h>p.y) dead=true;
  });
  if(dead){
    const msg=cruelMessages[Math.floor(Math.random()*cruelMessages.length)];
    showAIMessage(msg);
    shake=20;
    setTimeout(()=>{loadLevel(currentLevel);},800);
  }
}

// ===== Desenha =====
function draw(){
  if(gameFinished)return;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.save();
  ctx.translate(-camera.x,-camera.y);

  platforms.forEach(p=>{
    if(p.visible && !p.fake){
      ctx.fillStyle=p.color;
      ctx.shadowBlur=20; ctx.shadowColor=p.color;
      ctx.fillRect(p.x,p.y,p.w,p.h);
    }
  });

  projectiles.forEach(proj=>{
    ctx.fillStyle=proj.color;
    ctx.shadowBlur=15; ctx.shadowColor=proj.color;
    ctx.fillRect(proj.x,proj.y,proj.w,proj.h);
  });

  ctx.fillStyle=goal.color; ctx.shadowBlur=30; ctx.shadowColor=goal.color;
  ctx.fillRect(goal.x,goal.y,goal.w,goal.h);

  ctx.fillStyle=player.color;
  ctx.shadowBlur=30+player.glow; ctx.shadowColor=player.color;
  ctx.fillRect(player.x,player.y,player.w,player.h);
  player.glow=(player.glow+1)%20;

  ctx.restore();
}

// ===== Desenha IA =====
function drawAI(){
  if(aiTimer>0){
    ctx.save();
    ctx.fillStyle=`rgba(255,0,0,${aiTimer/250})`;
    ctx.font="28px Arial"; ctx.textAlign="center";
    ctx.fillText(aiMessage,camera.x+canvas.width/2,camera.y+100);
    ctx.restore(); aiTimer--;
  }
}

// ===== Loop =====
function loop(){ update(); checkDeath(); draw(); drawAI(); requestAnimationFrame(loop); }

// ===== Controles teclado =====
document.addEventListener("keydown",e=>{
  keys[e.key]=true;
  if((e.key==="ArrowUp"||e.key==="w"||e.key===" ") && player.onGround){player.vy=jumpForce;player.onGround=false;}
});
document.addEventListener("keyup",e=>{keys[e.key]=false;});

// ===== Controles mobile =====
const joystick=document.getElementById("joystick");
const joystickInner=document.getElementById("joystickInner");
let joystickActive=false, startX=0, startY=0;
joystick.addEventListener("touchstart",e=>{ joystickActive=true; startX=e.touches[0].clientX; startY=e.touches[0].clientY; });
joystick.addEventListener("touchmove",e=>{
  if(!joystickActive)return;
  let dx=e.touches[0].clientX-startX;
  if(dx<-10) mobileDir=-1; else if(dx>10) mobileDir=1; else mobileDir=0;
  joystickInner.style.left=`${30+dx/2}px`;
});
joystick.addEventListener("touchend",()=>{ joystickActive=false; mobileDir=0; joystickInner.style.left="30px"; });
document.getElementById("jumpBtn").addEventListener("touchstart",()=>{
  if(player.onGround){player.vy=jumpForce; player.onGround=false;}
});

// ===== Start =====
startBtn.addEventListener("click",()=>{
  startBtn.style.display="none";
  document.querySelector("h1").style.display="none";
  canvas.style.display="block";
  mobileControls.style.display="flex";
  loadLevel(0); loop();
});
</script>
</body>
</html>